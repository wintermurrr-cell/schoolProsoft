     1                                  global _start ; Объявляем точку входа _start глобальной
     2                                  
     3                                  section .data   ; Секция инициализированных данных
     4                                  
     5 00000000 456E74657220796F75-     enter_msg db "Enter your string: ", 0 ; Сообщение которым будем приглашать пользователя ввести текст
     5 00000009 7220737472696E673A-
     5 00000012 2000               
     6                                  enter_msg_len equ $ - enter_msg ; Вычисление длины строки
     7                                  
     8 00000014 52657665727365643A-     result_msg db "Reversed: ", 0 ; Сообщение которое будем выводить перед развернутой строкой
     8 0000001D 2000               
     9                                  result_msg_len equ $ - result_msg  ; Вычисление длины строки
    10                                  
    11 0000001F 616E206572726F7220-     error_msg db "an error occurred while executing the program", 10 ; Сообщение которое будем выводить при ошибке "во время выполнения программы произошла ошибка", с переходом на новую строку(10)
    11 00000028 6F6363757272656420-
    11 00000031 7768696C6520657865-
    11 0000003A 637574696E67207468-
    11 00000043 652070726F6772616D-
    11 0000004C 0A                 
    12                                  error_msg_len equ $ - error_msg ; Вычисление длины строки
    13                                  
    14                                  section .bss ; Секция неинициализированных данных
    15 00000000 <res 64h>               user_text resb 100 ; Резервируем 100 байт для пользовательского текста
    16 00000064 ????????                user_text_len resd 1  ; Длина строки в байтах, которую ввел пользователь
    17 00000068 <res 64h>               reverse_text resb 100 ; Резервируем 100 байт для развернутого текста
    18                                  reverse_text_len equ $ - reverse_text ; Вычисление длины реверсированной строки
    19                                  
    20                                  section .text  ; Секция текста программы
    21                                  _start: ; Точка входа программы
    22                                  
    23                                  ; Вывод текста в консоль
    24 00000000 B801000000              mov rax, 1 ; write (системный вызов)
    25 00000005 BF01000000              mov rdi, 1 ; дескриптор файла стандартного вызова stdout
    26 0000000A 48BE-                   mov rsi, enter_msg  ; адрес строки для вывода
    26 0000000C [0000000000000000] 
    27 00000014 BA14000000              mov rdx, enter_msg_len ; количество байтов
    28 00000019 0F05                    syscall ; Выполняем системный вызов вывода
    29                                  
    30 0000001B 4883F800                cmp rax, 0 ; Сравниваем возвращаемое значение с 0
    31 0000001F 0F8CA0000000            jl error_end ;Если число отрицательное - значит ошибка
    32                                  
    33 00000025 4883F814                cmp rax, enter_msg_len ; Сравниваем возвращенное значение с длинной
    34 00000029 0F8C96000000            jl error_end ; Если не равно - ошибка
    35                                  
    36                                  ; Считываем текст введенный пользователем
    37 0000002F B800000000              mov rax, 0 ; read (системный вызов)чтение
    38 00000034 BF00000000              mov rdi, 0 ; Читаем поток stdin
    39 00000039 48BE-                   mov rsi, user_text; Считываемый текст в переменную
    39 0000003B [0000000000000000] 
    40 00000043 BA64000000              mov rdx, 100 ; максимальное количество байт для чтения
    41 00000048 0F05                    syscall ; выполняем системный вызов чтения
    42                                  
    43 0000004A 48890425[64000000]      mov [user_text_len], rax ; пишем в переменную длину строки, которую ввел пользователь
    44                                  
    45 00000052 4883F800                cmp rax, 0 ; Проверка возвращаемого значения системного вызова
    46 00000056 7C6D                    jl error_end ;Если число отрицательное - значит ошибка
    47                                  
    48 00000058 488B0425[00000000]      mov rax, [user_text] ; Загружаем первый символ
    49 00000060 4883F80A                cmp rax, 10 ; Сравниваем с переносом строки
    50 00000064 745F                    jz error_end ; Если этот символ перенос строки - ошибка
    51                                  
    52 00000066 E881000000              call text_reverse ; Вызов функции для переворачивания текста
    53                                  
    54                                  ; Вывод текста в консоль
    55 0000006B B801000000              mov rax, 1  ; write (системный вызов)
    56 00000070 BF01000000              mov rdi, 1  ; дескриптор файла стандартного вызова stdout
    57 00000075 48BE-                   mov rsi, result_msg  ; адрес строки для вывода
    57 00000077 [1400000000000000] 
    58 0000007F BA0B000000              mov rdx, result_msg_len ; количество байтов для вывода
    59 00000084 0F05                    syscall ; Выполняем системный вызов вывода
    60                                  
    61 00000086 4883F800                cmp rax, 0 ; Проверка успешности вывода
    62 0000008A 7C39                    jl error_end ;Если число отрицательное - значит ошибка
    63                                  
    64 0000008C 4883F80B                cmp rax, result_msg_len ; Сравнение количества записанных байт с ожидаемой длиной
    65 00000090 7C33                    jl error_end ; Ошибка если записано другое кол-во байт чем ожидалось
    66                                  
    67                                  ; Вывод реверсивного текста в консоль
    68 00000092 B801000000              mov rax, 1 ; write (системный вызов)
    69 00000097 BF01000000              mov rdi, 1  ; дескриптор файла стандартного вызова stdout
    70 0000009C 48BE-                   mov rsi, reverse_text ; адрес строки для вывода
    70 0000009E [6800000000000000] 
    71 000000A6 BA64000000              mov rdx, reverse_text_len ; количество байтов для вывода
    72 000000AB 0F05                    syscall ; Выполняем системный вызов вывода
    73                                  
    74 000000AD 4883F800                cmp rax, 0 ; Проверка успешности вывода
    75 000000B1 7C12                    jl error_end ; Переход к ошибке если вернулось отрицательное значение
    76 000000B3 4883F864                cmp rax, reverse_text_len ; Сравнение длины записанных байт с ожидаемой длиной
    77 000000B7 7C0C                    jl error_end; переход к ошибке если другое кол-во байт чем ожидалось
    78                                  
    79                                  ; Выход из программы
    80 000000B9 B83C000000              mov rax, 60 ; exit (системный вызов)
    81 000000BE BF00000000              mov rdi, 0 ; код успешного выхода из программы
    82 000000C3 0F05                    syscall ; Системный вызов exit (успешное завершение)
    83                                  
    84                                  error_end:;Обработка ошибок
    85 000000C5 B801000000              mov rax, 1 ; write (системный вызов)
    86 000000CA BF02000000              mov rdi, 2 ; дескриптор файла стандартного вызова stdout
    87 000000CF 48BE-                   mov rsi, error_msg  ; адрес строки для вывода
    87 000000D1 [1F00000000000000] 
    88 000000D9 BA2E000000              mov rdx, error_msg_len ; количество байтов
    89 000000DE 0F05                    syscall;  Системный вызов вывода сообщения об ошибке
    90                                  
    91 000000E0 B83C000000              mov rax, 60 ; exit (системный вызов)
    92 000000E5 BF02000000              mov rdi, 2 ; код выхода из программы с ошибкой
    93 000000EA 0F05                    syscall ; Вызов системной функции выход с кодом ошибки
    94                                  
    95                                  text_reverse: ; Функция для переворота текстовой строки через стек
    96 000000EC 48BE-                   mov rsi, user_text ; Помещаем адрес первого символа введенный пользователем в переменную
    96 000000EE [0000000000000000] 
    97 000000F6 488B0C25[64000000]      mov rcx, [user_text_len] ; Указываем число повторений для loop
    98 000000FE 48FFC9                  dec rcx    ; Уменьшаем цикл на 1 (при чтении пропускаем символ переноса строки)
    99                                  
   100                                  stack_loop_push: ; помещаем символы в стек
   101 00000101 AC                      lodsb   ; помещаем символ из RSI в RAX и перемещаемся на элемент вправо
   102 00000102 50                      push rax ; помещаем букву в стек
   103                                  
   104 00000103 E2FC                    loop stack_loop_push    ; Повторение перемещения на тег пока RCX не будет равен нулю
   105                                  ; Продолжаем выполнение text_reverse
   106                                  
   107 00000105 488B0C25[64000000]      mov rcx, [user_text_len]  ; Указываем число повторений для loop
   108 0000010D 48FFC9                  dec rcx  ; Уменьшаем цикл на 1 (в стеке уже на один символ меньше)
   109 00000110 49B9-                   mov r9, reverse_text  ; Помещаем в r9 адрес на первый символ массива reverse_text
   109 00000112 [6800000000000000] 
   110                                  
   111                                  stack_loop_pop: ; извлечение символов из стека
   112 0000011A 58                      pop rax ; Извлекаем в rax верхний элемент стека
   113 0000011B 418801                  mov [r9], al  ; Помещаем букву в ячейку массива
   114 0000011E 4D8D4901                lea r9, [r9 + 1] ; Записываем в r9 адрес следующей ячейки
   115                                  
   116 00000122 E2F6                    loop stack_loop_pop ; Повторения цикла перемещенеия на тег пока RCX не будет равен нулю
   117                                  ; Продолжаем выполнение text_reverse
   118                                  
   119 00000124 41C6010A                mov byte [r9], 10 ; После вывода реверсного текста, перенос строки
   120                                  
   121 00000128 C3                      ret ; Возврат из функции
